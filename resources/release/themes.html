<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>margaui — theme switcher</title>
  <style id="theme-style"></style>
  <style id="margaui"></style>
  <style>
    /* Page layout — unlayered so it beats the Tailwind reset */
    * { box-sizing: border-box; }
    body { margin: 0; min-height: 100vh; background: var(--color-base-200); }
    .page { max-width: 72rem; margin: 0 auto; padding: 1rem; }
    .theme-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(7rem, 1fr));
      gap: 0.5rem;
      margin-bottom: 2rem;
    }
    .theme-btn {
      padding: 0.5rem 0.75rem;
      border: 2px solid var(--color-base-300);
      border-radius: 0.5rem;
      background: var(--color-base-100);
      color: var(--color-base-content);
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      text-align: center;
      transition: border-color 0.15s;
    }
    .theme-btn:hover { border-color: var(--color-primary); }
    .theme-btn.active { border-color: var(--color-primary); background: var(--color-primary); color: var(--color-primary-content); }
    .swatch-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(8rem, 1fr));
      gap: 0.75rem;
      margin-bottom: 2rem;
    }
    .swatch {
      border-radius: 0.5rem;
      overflow: hidden;
      border: 1px solid var(--color-base-300);
    }
    .swatch-color {
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
    }
    .swatch-label {
      padding: 0.375rem 0.5rem;
      font-size: 0.6875rem;
      background: var(--color-base-100);
      text-align: center;
    }
    .section-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin: 2rem 0 1rem;
    }
    .component-row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: start;
      margin-bottom: 1.5rem;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar bg-base-100 shadow-sm">
    <span class="navbar-start">
      <span style="font-size:1.25rem;font-weight:700;padding-left:1rem">margaui themes</span>
    </span>
    <span class="navbar-end" style="padding-right:1rem">
      <select id="theme-select" class="select select-sm select-bordered">
        <option value="" disabled>Pick a theme</option>
      </select>
    </span>
  </nav>

  <div class="page">
    <!-- Theme buttons grid -->
    <h2 class="section-title">Themes</h2>
    <div id="theme-grid" class="theme-grid"></div>

    <!-- Color swatches -->
    <h2 class="section-title">Semantic Colors</h2>
    <div class="swatch-grid">
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-primary);color:var(--color-primary-content)">Aa</div>
        <div class="swatch-label">primary</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-secondary);color:var(--color-secondary-content)">Aa</div>
        <div class="swatch-label">secondary</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-accent);color:var(--color-accent-content)">Aa</div>
        <div class="swatch-label">accent</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-neutral);color:var(--color-neutral-content)">Aa</div>
        <div class="swatch-label">neutral</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-info);color:var(--color-info-content)">Aa</div>
        <div class="swatch-label">info</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-success);color:var(--color-success-content)">Aa</div>
        <div class="swatch-label">success</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-warning);color:var(--color-warning-content)">Aa</div>
        <div class="swatch-label">warning</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-error);color:var(--color-error-content)">Aa</div>
        <div class="swatch-label">error</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-base-100);color:var(--color-base-content)">Aa</div>
        <div class="swatch-label">base-100</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-base-200);color:var(--color-base-content)">Aa</div>
        <div class="swatch-label">base-200</div>
      </div>
      <div class="swatch">
        <div class="swatch-color" style="background:var(--color-base-300);color:var(--color-base-content)">Aa</div>
        <div class="swatch-label">base-300</div>
      </div>
    </div>

    <!-- Sample components -->
    <h2 class="section-title">Components</h2>

    <!-- Card -->
    <div class="component-row">
      <div class="card bg-base-100 shadow-lg" style="width:20rem">
        <div class="card-body">
          <h2 class="card-title">Card Title</h2>
          <p>This card updates when you switch themes.</p>
          <div class="card-actions justify-end">
            <button class="btn btn-primary btn-sm">Action</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="component-row">
      <button class="btn btn-primary">Primary</button>
      <button class="btn btn-secondary">Secondary</button>
      <button class="btn btn-accent">Accent</button>
      <button class="btn btn-info">Info</button>
      <button class="btn btn-success">Success</button>
      <button class="btn btn-warning">Warning</button>
      <button class="btn btn-error">Error</button>
    </div>

    <!-- Badges -->
    <div class="component-row">
      <span class="badge badge-primary badge-lg">primary</span>
      <span class="badge badge-secondary badge-lg">secondary</span>
      <span class="badge badge-accent badge-lg">accent</span>
      <span class="badge badge-info badge-lg">info</span>
      <span class="badge badge-success badge-lg">success</span>
      <span class="badge badge-warning badge-lg">warning</span>
      <span class="badge badge-error badge-lg">error</span>
    </div>

    <!-- Alert -->
    <div class="component-row" style="width:100%">
      <div class="alert alert-info" style="flex:1">
        <span>This is an info alert — theme colors apply everywhere.</span>
      </div>
    </div>
  </div>

  <script type="module">
    import { getCompiler } from "./margaui.min.js";

    const THEMES = [
      "light", "dark", "abyss", "acid", "aqua", "autumn", "black", "bumblebee",
      "business", "caramellatte", "cmyk", "coffee", "corporate", "cupcake",
      "cyberpunk", "dim", "dracula", "emerald", "fantasy", "forest", "garden",
      "halloween", "lemonade", "lofi", "luxury", "night", "nord", "pastel",
      "retro", "silk", "sunset", "synthwave", "valentine", "winter", "wireframe",
    ];

    const compiler = await getCompiler();

    // Compile all classes used on the page
    const css = compiler.build([
      "navbar", "bg-base-100", "shadow-sm", "navbar-start", "navbar-end",
      "select", "select-sm", "select-bordered",
      "card", "card-body", "card-title", "card-actions", "shadow-lg",
      "btn", "btn-sm", "btn-primary", "btn-secondary", "btn-accent",
      "btn-info", "btn-success", "btn-warning", "btn-error",
      "badge", "badge-primary", "badge-secondary", "badge-accent",
      "badge-info", "badge-success", "badge-warning", "badge-error", "badge-lg",
      "alert", "alert-info",
      "justify-end",
    ]);
    document.getElementById("margaui").textContent = css;

    // Load initial theme
    const themeCss = await fetch("./themes/light.css").then(r => r.text());
    document.getElementById("theme-style").textContent = themeCss;

    // Populate theme dropdown
    const themeSelect = document.getElementById("theme-select");
    for (const t of THEMES) {
      const opt = document.createElement("option");
      opt.value = t;
      opt.textContent = t;
      if (t === "light") opt.selected = true;
      themeSelect.appendChild(opt);
    }

    // Populate theme button grid
    const grid = document.getElementById("theme-grid");
    for (const t of THEMES) {
      const btn = document.createElement("button");
      btn.className = "theme-btn" + (t === "light" ? " active" : "");
      btn.textContent = t;
      btn.dataset.theme = t;
      grid.appendChild(btn);
    }

    let currentTheme = "light";

    async function switchTheme(name) {
      currentTheme = name;
      const css = await fetch(`./themes/${name}.css`).then(r => r.text());
      document.getElementById("theme-style").textContent = css;
      document.documentElement.setAttribute("data-theme", name);
      themeSelect.value = name;
      grid.querySelectorAll(".theme-btn").forEach(btn => {
        btn.classList.toggle("active", btn.dataset.theme === name);
      });
    }

    themeSelect.addEventListener("change", () => switchTheme(themeSelect.value));
    grid.addEventListener("click", (e) => {
      const btn = e.target.closest(".theme-btn");
      if (btn) switchTheme(btn.dataset.theme);
    });
  </script>
</body>
</html>
